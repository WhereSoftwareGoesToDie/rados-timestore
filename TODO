* unsafePartsOf appears in more than one place, need to remove that
  duplication.
* handle exceptions and bad input data correctly
